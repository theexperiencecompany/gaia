# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸŒ GAIA Monorepo - Root mise.toml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# mise manages tools (node, python, nx) and task execution
# nx manages build caching and project graph
#
# Quick Start:
#   mise setup        # First-time setup (all apps)
#   mise dev          # Start API + web
#   mise tasks        # List all available tasks
#
# Documentation: https://docs.heygaia.io/developers/commands
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”§ TOOLS & ENVIRONMENT
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tools]
python = "3.12"
node = "22"
uv = "latest"
prek = "0.2.23"
"npm:nx" = "latest"
"npm:mintlify" = "latest"

[env]
_.python.venv = { path = ".venv", create = true }
MISE_NODE_COREPACK = "1"

[settings]
experimental = true

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸš€ SETUP & INSTALLATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks."setup:env"]
description = "Check if environment files exist for all apps"
run = '''
echo "ğŸ” Checking environment files..."
missing=""

# API (Manual check)
if [ ! -f "apps/api/.env" ]; then
    missing="$missing\n  cp apps/api/.env.example apps/api/.env"
fi

# Web (Auto-copy)
if [ ! -f "apps/web/.env" ] && [ -f "apps/web/.env.example" ]; then
    echo "âœ¨ Creating apps/web/.env from example (no secrets)"
    cp apps/web/.env.example apps/web/.env
fi

# Mobile (Auto-copy)
if [ ! -f "apps/mobile/.env" ] && [ -f "apps/mobile/.env.example" ]; then
    echo "âœ¨ Creating apps/mobile/.env from example (no secrets)"
    cp apps/mobile/.env.example apps/mobile/.env
fi

if [ -n "$missing" ]; then
    echo "âŒ Missing API environment file!"
    echo ""
    echo "Please copy the example file (contains secrets):"
    echo -e "$missing"
    exit 1
fi
echo "âœ… Environment files ready"
'''

[tasks."setup:api"]
description = "Install API dependencies (Python/uv)"
dir = "apps/api"
run = "uv sync --group backend --group dev"

[tasks."setup:web"]
description = "Install web dependencies (pnpm)"
run = "pnpm install --filter web..."

[tasks."setup:mobile"]
description = "Install mobile dependencies (Expo)"
dir = "apps/mobile"
run = "pnpm install"

[tasks."setup:desktop"]
description = "Install desktop dependencies (Electron)"
dir = "apps/desktop"
run = "pnpm install"

[tasks."setup:voice-agent"]
description = "Install voice agent dependencies + download models"
dir = "apps/voice-agent"
run = "uv sync && uv run python -m src download-files"

[tasks."setup:deps"]
description = "Install all project dependencies"
run = '''
echo "ğŸ“¦ Installing all dependencies..."
pnpm install
echo "ğŸ Installing API dependencies..."
(cd apps/api && uv sync --group backend --group dev)
echo "ğŸ¤ Installing voice-agent dependencies..."
(cd apps/voice-agent && uv sync)
echo "âœ… All dependencies installed"
'''

[tasks.setup]
description = "Complete project setup for all apps (API, Web, Desktop, Mobile, Voice)"
depends = ["setup:env", "setup:deps"]
run = '''
echo "ğŸ³ Starting Docker services..."
nx run docker:docker:up
echo "ğŸŒ± Seeding AI models..."
(cd apps/api && uv run --group backend python scripts/seed_models.py --force)
echo ""
echo "âœ… Setup complete! Run 'mise dev' to start development servers."
'''

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ–¥ï¸ DEVELOPMENT COMMANDS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks.dev]
description = "Run API + web in parallel (starts Docker automatically)"
run = "nx run docker:docker:up && nx run-many -t dev --projects=api,web --parallel=2"

[tasks."dev:api"]
description = "Run ONLY API server (starts Docker automatically)"
run = "nx run docker:docker:up && nx dev api"

[tasks."dev:web"]
description = "Run ONLY web (starts Docker automatically)"
run = "nx run docker:docker:up && nx dev web"

[tasks."dev:mobile"]
description = "Run Mobile App + API (starts Docker automatically)"
run = "nx run docker:docker:up && nx run-many -t dev --projects=api,mobile --parallel=2"

[tasks."dev:desktop"]
description = "Run desktop app in development mode (requires web dev server)"
run = "nx dev desktop"

[tasks."dev:docs"]
description = "Run ONLY docs (Mintlify)"
run = "nx dev docs"

[tasks."dev:arq"]
description = "Run ONLY ARQ worker"
dir = "apps/api"
run = "mise worker"

[tasks."dev:voice"]
description = "Run ONLY voice agent worker"
run = "nx dev voice-agent"

[tasks."dev:full"]
description = "Run API + web + arq worker + voice agent in parallel"
run = "nx run docker:docker:up && nx run-many -t dev,worker --projects=api,web,voice-agent --parallel=4"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ—ï¸ BUILD COMMANDS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks.build]
description = "Build all apps"
run = "nx run-many -t build"

[tasks."build:web"]
description = "Build web only"
run = "nx build web"

[tasks."build:docs"]
description = "Build docs only"
run = "nx build docs"

[tasks."build:affected"]
description = "Build only affected projects"
run = "nx affected -t build"

[tasks."build:desktop"]
description = "Build desktop app (builds web first)"
run = "nx build web && nx build desktop"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§ª TEST COMMANDS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks.test]
description = "Test all apps"
run = "nx run-many -t test"

[tasks."test:api"]
description = "Test API only"
run = "nx test api"

[tasks."test:web"]
description = "Test web only"
run = "nx test web"

[tasks."test:affected"]
description = "Test only affected projects"
run = "nx affected -t test"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” LINTING & FORMATTING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks.lint]
description = "Lint all apps (parallel with caching)"
run = "nx run-many -t lint --parallel=3"

[tasks."lint:fix"]
description = "Lint and fix all apps"
run = "nx run-many -t lint:fix --parallel=3"

[tasks."lint:api"]
description = "Lint API only"
run = "nx lint api"

[tasks."lint:web"]
description = "Lint web only"
run = "nx lint web"

[tasks."lint:mobile"]
description = "Lint mobile only"
run = "nx lint mobile"

[tasks."lint:affected"]
description = "Lint only affected projects (parallel with caching)"
run = "nx affected -t lint --parallel=3"

[tasks.format]
description = "Format and write changes to all apps (parallel)"
run = "nx run-many -t format --parallel=3"

[tasks."format:check"]
description = "Check formatting for all apps (parallel with caching)"
run = "nx run-many -t format:check --parallel=3"

[tasks."format:api"]
description = "Format and write changes to API only"
run = "nx format api"

[tasks."format:web"]
description = "Format and write changes to web only"
run = "nx format web"

[tasks."format:affected"]
description = "Format and write changes to affected projects (parallel)"
run = "nx affected -t format --parallel=3"

[tasks."type-check"]
description = "Type-check all apps (parallel with caching)"
run = "nx run-many -t type-check --parallel=3"

[tasks."type-check:affected"]
description = "Type-check only affected projects (parallel with caching)"
run = "nx affected -t type-check --parallel=3"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”— PRE-COMMIT HOOKS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks."pre-commit"]
description = "Run all pre-commit checks (workspace mode)"
run = "prek run --all-files"

[tasks."pre-commit:install"]
description = "Install pre-commit hooks using prek"
run = "prek install"

[tasks."pre-commit:run"]
description = "Run pre-commit hooks on staged files"
run = "prek run"

[tasks."pre-commit:api"]
description = "Run pre-commit checks for API only"
run = "prek run apps/api/"

[tasks."pre-commit:web"]
description = "Run pre-commit checks for web only"
run = "prek run apps/web/"

[tasks."pre-commit:uninstall"]
description = "Uninstall pre-commit hooks"
run = "prek uninstall"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ–¥ï¸ DESKTOP DISTRIBUTION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks."pack:desktop"]
description = "Package desktop app without distributing"
run = "nx pack desktop"

[tasks."dist:desktop"]
description = "Create distributable desktop packages for current platform"
run = "nx dist desktop"

[tasks."dist:desktop:mac"]
description = "Create macOS distributable (DMG + ZIP)"
run = "nx dist:mac desktop"

[tasks."dist:desktop:win"]
description = "Create Windows distributable (NSIS + Portable)"
run = "nx dist:win desktop"

[tasks."dist:desktop:linux"]
description = "Create Linux distributable (AppImage + DEB + RPM)"
run = "nx dist:linux desktop"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§¹ CLEAN & MAINTENANCE
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks.clean]
description = "Clean all apps"
run = "nx run-many -t clean"

[tasks."clean:nx"]
description = "Clean Nx cache"
run = "nx reset"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ“Š NX UTILITIES
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks.graph]
description = "Show Nx project graph"
run = "nx graph"

[tasks."affected:graph"]
description = "Show affected projects graph"
run = "nx affected:graph"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”„ CI/CD COMMANDS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[tasks."ci:desktop"]
description = "Test desktop-release workflow locally with act (dry-run)"
run = "act release --job build -n --eventpath .github/test-events/release.json"

[tasks."ci:desktop:run"]
description = "Actually run desktop-release workflow locally with act"
run = "act release --job build --eventpath .github/test-events/release.json"

[tasks."ci:list"]
description = "List all available GitHub Actions workflows"
run = "act -l"

[tasks."ci:release-please"]
description = "Test release-please workflow locally with act (dry-run)"
run = "act push -n --job release-please"

[tasks."ci:quality"]
description = "Test main.yml quality-checks workflow (dry-run)"
run = "act pull_request -n --job quality-checks"

[tasks."ci:quality:run"]
description = "Actually run quality-checks locally with act"
run = "act pull_request --job quality-checks"

[tasks."ci:build"]
description = "Test build.yml workflow (dry-run)"
run = "act workflow_call -n -W .github/workflows/build.yml"

[tasks."ci:all"]
description = "List all jobs across all workflows"
run = "act -l --workflows .github/workflows/"
